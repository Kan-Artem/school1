{"version":3,"sources":["./src/app/plugins/posts-manager/post-editor/post-editor.component.html","./src/app/plugins/posts-manager/posts-list/posts-list.component.html","./src/app/plugins/posts-manager/post-editor/post-editor.component.css","./src/app/plugins/posts-manager/post-editor/post-editor.component.ts","./src/app/plugins/posts-manager/posts-list/posts-list.component.css","./src/app/plugins/posts-manager/posts-list/posts-list.component.ts","./src/app/plugins/posts-manager/posts-manager-routing.module.ts","./src/app/plugins/posts-manager/posts-manager.service.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["export default \"<div class=\\\"wrapper\\\">\\n  <div class=\\\"top\\\">\\n    <div class=\\\"preview-upload\\\">\\n      <img [src]=\\\"data.preview_url || 'https://via.placeholder.com/470x330'\\\"\\n        #previewbox class=\\\"preview-box\\\">\\n      <button (click)=\\\"input.click()\\\" class=\\\"preview-input\\\">Загрузить превью</button>\\n      <input type=\\\"file\\\" #input (change)=\\\"preview(input)\\\" class=\\\"hidden\\\">\\n    </div>\\n    <textarea\\n      type=\\\"text\\\" name=\\\"title\\\"\\n      class=\\\"title-input\\\"\\n      placeholder=\\\"Название\\\"\\n      [(ngModel)]=\\\"data.title\\\">\\n    </textarea>\\n  </div>\\n  <div class=\\\"editor-wrapper\\\">\\n    <quill-editor\\n      [(ngModel)]=\\\"data.text\\\"\\n      placeholder=\\\"Редактор поста\\\"\\n    ></quill-editor>\\n  </div>\\n  <button (click)=\\\"submit()\\\">Отправить</button>\\n</div>\\n\"","export default \"<a\\n  [routerLink]=\\\"[ 'new' ]\\\"\\n  class=\\\"create-post-link\\\"\\n>Создать новый пост</a>\\n<ul class=\\\"posts-list\\\">\\n  <li *ngFor=\\\"let post of posts; index as i\\\" class=\\\"post-li\\\">\\n    <div class  =\\\"post-box\\\">\\n      <div class=\\\"post-name\\\">{{ post.title }}</div>\\n      <a [routerLink]=\\\"['edit', post.id]\\\" class=\\\"btn-post edit-post\\\">E</a>\\n      <button (click)=\\\"delete(post.id, i)\\\" class=\\\"btn-post delete-post\\\">D</button>\\n    </div>\\n  </li>\\n</ul>\\n\\n<p class=\\\"empty-note\\\" *ngIf=\\\"posts.length === 0\\\">Нет ниодного поста :(</p>\"","export default \".top {\\n  display: flex;\\n}\\n\\n.title-input {\\n  width: 100%;\\n  padding: 5px;\\n  margin-left: 15px;\\n  margin-bottom: 5px;\\n  resize: none;\\n  font-size: 38px;\\n  line-height: 1.3;\\n  color: #343F64;\\n}\\n\\n.preview-upload {\\n  max-width: 470px;\\n  position: relative;\\n}\\n\\n.preview-box {\\n  display: block;\\n  border: 1px solid #fff;\\n  max-width: 470px;\\n  max-height: 330px;\\n  background: #CCCCCC;\\n}\\n\\n.preview-input {\\n  width: 100%;\\n  margin: 5px 0;\\n  background: #FEC525;\\n  border: 2px solid #A10000;\\n  height: 2em;\\n}\\n\\n.editor-wrapper {\\n  background: #fff;\\n}\\n\\n@media (max-width: 1200px) {\\n  .top {\\n    flex-direction: column;\\n    align-items: center;\\n  }\\n\\n  .title-input {\\n    margin-left: 0;\\n    margin-top: 5px;\\n    font-size: 20px;\\n    height: 3em;\\n  }\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9wbHVnaW5zL3Bvc3RzLW1hbmFnZXIvcG9zdC1lZGl0b3IvcG9zdC1lZGl0b3IuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQWE7QUFDZjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0VBQ1osaUJBQWlCO0VBQ2pCLGtCQUFrQjtFQUNsQixZQUFZO0VBQ1osZUFBZTtFQUNmLGdCQUFnQjtFQUNoQixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxzQkFBc0I7RUFDdEIsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtFQUNqQixtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsYUFBYTtFQUNiLG1CQUFtQjtFQUNuQix5QkFBeUI7RUFDekIsV0FBVztBQUNiOztBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0U7SUFDRSxzQkFBc0I7SUFDdEIsbUJBQW1CO0VBQ3JCOztFQUVBO0lBQ0UsY0FBYztJQUNkLGVBQWU7SUFDZixlQUFlO0lBQ2YsV0FBVztFQUNiO0FBQ0YiLCJmaWxlIjoiYXBwL3BsdWdpbnMvcG9zdHMtbWFuYWdlci9wb3N0LWVkaXRvci9wb3N0LWVkaXRvci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnRvcCB7XG4gIGRpc3BsYXk6IGZsZXg7XG59XG5cbi50aXRsZS1pbnB1dCB7XG4gIHdpZHRoOiAxMDAlO1xuICBwYWRkaW5nOiA1cHg7XG4gIG1hcmdpbi1sZWZ0OiAxNXB4O1xuICBtYXJnaW4tYm90dG9tOiA1cHg7XG4gIHJlc2l6ZTogbm9uZTtcbiAgZm9udC1zaXplOiAzOHB4O1xuICBsaW5lLWhlaWdodDogMS4zO1xuICBjb2xvcjogIzM0M0Y2NDtcbn1cblxuLnByZXZpZXctdXBsb2FkIHtcbiAgbWF4LXdpZHRoOiA0NzBweDtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xufVxuXG4ucHJldmlldy1ib3gge1xuICBkaXNwbGF5OiBibG9jaztcbiAgYm9yZGVyOiAxcHggc29saWQgI2ZmZjtcbiAgbWF4LXdpZHRoOiA0NzBweDtcbiAgbWF4LWhlaWdodDogMzMwcHg7XG4gIGJhY2tncm91bmQ6ICNDQ0NDQ0M7XG59XG5cbi5wcmV2aWV3LWlucHV0IHtcbiAgd2lkdGg6IDEwMCU7XG4gIG1hcmdpbjogNXB4IDA7XG4gIGJhY2tncm91bmQ6ICNGRUM1MjU7XG4gIGJvcmRlcjogMnB4IHNvbGlkICNBMTAwMDA7XG4gIGhlaWdodDogMmVtO1xufVxuXG4uZWRpdG9yLXdyYXBwZXIge1xuICBiYWNrZ3JvdW5kOiAjZmZmO1xufVxuXG5AbWVkaWEgKG1heC13aWR0aDogMTIwMHB4KSB7XG4gIC50b3Age1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgfVxuXG4gIC50aXRsZS1pbnB1dCB7XG4gICAgbWFyZ2luLWxlZnQ6IDA7XG4gICAgbWFyZ2luLXRvcDogNXB4O1xuICAgIGZvbnQtc2l6ZTogMjBweDtcbiAgICBoZWlnaHQ6IDNlbTtcbiAgfVxufVxuIl19 */\"","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { PostsManagerService, post } from '../posts-manager.service';\n\n@Component({\n  selector: 'app-post-editor',\n  templateUrl: './post-editor.component.html',\n  styleUrls: ['./post-editor.component.css']\n})\nexport class PostEditorComponent implements OnInit {\n  @ViewChild('editor', { static: false }) editorRef: ElementRef;\n  data: post = {\n    title: '',\n    text: '',\n    date: '',\n    id: 0,\n    preview_url: '',\n  };\n\n  id: post['id'];\n\n  private fileReader = new FileReader;\n\n  constructor(\n    private http: PostsManagerService,\n    private route: ActivatedRoute,\n    private router: Router,\n  ) {\n    this.fileReader.addEventListener('load', () => {\n      this.data.preview_url = this.fileReader.result + '';\n    }, false);\n  }\n\n  ngOnInit() {\n    const id = this.route.snapshot.params['id'];\n    if (id != null) {\n      this.id = id;\n      this.http\n        .getPost(this.id)\n        .subscribe(rs => {\n          this.data = rs;\n        });\n    }\n  }\n\n  preview(input: HTMLInputElement) {\n    const file = input.files[0];\n    if (file == null) return;\n    this.fileReader.readAsDataURL(file);\n  }\n\n  async submit() {\n    const formData = this.data;\n\n    if (this.id) { // to update\n      this.http.updatePost(formData)\n        .subscribe((rs) => {\n          alert(`[UPDATE]: ${rs['ok'] ? 'Success' : 'Fail'}`);\n        });\n    } else { // to create new\n      this.http.newPost(formData)\n        .subscribe(async (rs) => {\n          if (!rs['ok']) {\n            return alert('[UPDATE]: Fail');\n          }\n\n          if (this.data.preview_url\n            && this.data.preview_url.startsWith('data:image/')) {\n            formData.preview_url = await this.http\n              .uploadImage(this.data.preview_url, this.data.id);\n          }\n\n          this.router.navigate([ '/', 'posts', 'edit', this.data.id ]);\n        });\n    }\n  }\n}\n","export default \".post-li {\\n  border: 2px solid #5C3617;\\n  border-bottom: 0;\\n  padding: 8px 15px;\\n  background: #D5D5D5;\\n  color: #000;\\n}\\n\\n.post-li:last-child {\\n  border-bottom: 2px solid #251D00;\\n}\\n\\n.post-box {\\n  display: flex;\\n}\\n\\n.post-name {\\n  width: 100%;\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n  white-space: nowrap;\\n}\\n\\n.btn-post {\\n  width: 22px;\\n  height: 22px;\\n  border: 2px solid #000;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  margin: 0 3px;\\n}\\n\\n.create-post-link {\\n  display: block;\\n  border: 2px solid #4a4823;\\n  background: #edff78;\\n  padding: 8px 15px;\\n  margin-bottom: 15px;\\n}\\n\\n.empty-note {\\n  font-style: italic;\\n  font-size: 20px;\\n  padding-left: 3em;\\n  margin-top: 1.4em;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9wbHVnaW5zL3Bvc3RzLW1hbmFnZXIvcG9zdHMtbGlzdC9wb3N0cy1saXN0LmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSx5QkFBeUI7RUFDekIsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtFQUNqQixtQkFBbUI7RUFDbkIsV0FBVztBQUNiOztBQUVBO0VBQ0UsZ0NBQWdDO0FBQ2xDOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsV0FBVztFQUNYLHVCQUF1QjtFQUN2QixnQkFBZ0I7RUFDaEIsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsYUFBYTtFQUNiLHVCQUF1QjtFQUN2QixtQkFBbUI7RUFDbkIsYUFBYTtBQUNmOztBQUVBO0VBQ0UsY0FBYztFQUNkLHlCQUF5QjtFQUN6QixtQkFBbUI7RUFDbkIsaUJBQWlCO0VBQ2pCLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixlQUFlO0VBQ2YsaUJBQWlCO0VBQ2pCLGlCQUFpQjtBQUNuQiIsImZpbGUiOiJhcHAvcGx1Z2lucy9wb3N0cy1tYW5hZ2VyL3Bvc3RzLWxpc3QvcG9zdHMtbGlzdC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnBvc3QtbGkge1xuICBib3JkZXI6IDJweCBzb2xpZCAjNUMzNjE3O1xuICBib3JkZXItYm90dG9tOiAwO1xuICBwYWRkaW5nOiA4cHggMTVweDtcbiAgYmFja2dyb3VuZDogI0Q1RDVENTtcbiAgY29sb3I6ICMwMDA7XG59XG5cbi5wb3N0LWxpOmxhc3QtY2hpbGQge1xuICBib3JkZXItYm90dG9tOiAycHggc29saWQgIzI1MUQwMDtcbn1cblxuLnBvc3QtYm94IHtcbiAgZGlzcGxheTogZmxleDtcbn1cblxuLnBvc3QtbmFtZSB7XG4gIHdpZHRoOiAxMDAlO1xuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbn1cblxuLmJ0bi1wb3N0IHtcbiAgd2lkdGg6IDIycHg7XG4gIGhlaWdodDogMjJweDtcbiAgYm9yZGVyOiAycHggc29saWQgIzAwMDtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIG1hcmdpbjogMCAzcHg7XG59XG5cbi5jcmVhdGUtcG9zdC1saW5rIHtcbiAgZGlzcGxheTogYmxvY2s7XG4gIGJvcmRlcjogMnB4IHNvbGlkICM0YTQ4MjM7XG4gIGJhY2tncm91bmQ6ICNlZGZmNzg7XG4gIHBhZGRpbmc6IDhweCAxNXB4O1xuICBtYXJnaW4tYm90dG9tOiAxNXB4O1xufVxuXG4uZW1wdHktbm90ZSB7XG4gIGZvbnQtc3R5bGU6IGl0YWxpYztcbiAgZm9udC1zaXplOiAyMHB4O1xuICBwYWRkaW5nLWxlZnQ6IDNlbTtcbiAgbWFyZ2luLXRvcDogMS40ZW07XG59XG4iXX0= */\"","import { Component, OnInit } from '@angular/core';\nimport { PostsManagerService, post } from '../posts-manager.service';\n\n@Component({\n  selector: 'app-posts-list',\n  templateUrl: './posts-list.component.html',\n  styleUrls: ['./posts-list.component.css']\n})\nexport class PostsListComponent implements OnInit {\n  posts: post[] = [];\n\n  constructor(private http: PostsManagerService) { }\n\n  ngOnInit() {\n    this.initList();\n  }\n\n  initList() {\n    this.http.getList().subscribe(ps => this.posts = ps);\n  }\n\n  delete(id: number, index: number) {\n    return this.http.deletePost(id)\n      .subscribe((response) => {\n        if (response['ok']) {\n          alert('The post is deleted successfully.');\n          this.posts.splice(index, 1);\n        } else {\n          alert('The fail to delete the post.');\n        }\n      });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { PostEditorComponent } from './post-editor/post-editor.component';\nimport { PostsListComponent } from './posts-list/posts-list.component';\n\nconst routes: Routes = [\n  { path: 'edit/:id', component: PostEditorComponent },\n  { path: 'new', component: PostEditorComponent },\n  { path: '', pathMatch: 'full', component: PostsListComponent },\n  { path: '**', redirectTo: '' },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class PostsManagerRoutingModule { }\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\n\nimport { Observable, from } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\nimport { generate as shortid } from 'shortid';\n\nimport { AuthService } from '../../auth.service';\n\nexport type post = {\n  title: string;\n  id: number;\n  text: string;\n  date: string;\n  preview_url: string;\n};\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PostsManagerService {\n\n  constructor(\n    private http: HttpClient,\n    private auth: AuthService,\n  ) { }\n\n  getPost(id: number) {\n    return this.http.get<post>(\n      `/handle.php?action=getpost&id=${id}&` +\n      `key=${this.auth.getKey()}`\n    );\n  }\n\n  getList() {\n    return this.http.get<post[]>(\n      '/handle.php?action=listposts&' +\n      `key=${this.auth.getKey()}`\n    );\n  }\n\n  newPost(data: Partial<post>) {\n    return this.http.post('/handle.php', {\n      action: 'newpost',\n      key: this.auth.getKey(),\n      title: data.title,\n      text: '.',\n    }).pipe(mergeMap((rs) => {\n        if (!rs['ok']) return;\n        data.id = rs['id'];\n        return from(this.uploadImagesFromPost(data))\n          .pipe(mergeMap(() =>\n            this.http.post('/handle.php', {\n              action: 'editpost', ...data,\n              key: this.auth.getKey(),\n            })));\n      }));\n  }\n\n  updatePost(data: Partial<post>) {\n    return from(this.uploadImagesFromPost(data))\n      .pipe(mergeMap(() =>\n        this.http.post('/handle.php', {\n          action: 'editpost', ...data,\n          key: this.auth.getKey(),\n        })));\n  }\n\n  deletePost(id: number) {\n    return this.http.delete(\n      `/handle.php?action=deletepost&id=${id}&` +\n      `key=${this.auth.getKey()}`\n    );\n  }\n\n  private async uploadImagesFromPost(post: Partial<post>) {\n    const html = document.createElement('div');\n    html.innerHTML = post.text;\n    const postId = post.id;\n    const images: HTMLImageElement[] = Array.from(\n        html.querySelectorAll('img[src^=\"data:image/\"]'));\n    for (const image of images) {\n      const path = await this.uploadImage(image.src, postId);\n      image.src = path;\n    }\n    post.text = html.innerHTML;\n  }\n\n  uploadImage(dataUrl: string, postId): Promise<string> {\n    const ext = /^data:image\\/(\\w+)/.exec(dataUrl)[1];\n    const file = this.imgDataUrlToFile(dataUrl, `image.${ext}`);\n\n    const formData = new FormData;\n    formData.append('image', file);\n    formData.append('postid', postId);\n    // formData.append('s_key', 'admin_key');\n\n    return fetch(\n      '/handle.php?action=uploadimage&key=' + this.auth.getKey(),\n    {\n      method: 'POST',\n      body: formData\n    }).then((res) => res.json())\n      .then((json) => {\n        console.log(json);\n        return json['filepaths']['image'];\n      });\n  }\n\n  private imgDataUrlToFile(dataurl, filename) {\n    const arr = dataurl.split(',');\n    const mime = arr[0].match(/:(.*?);/)[1];\n    const bstr = atob(arr[1]);\n    let n = bstr.length;\n    const u8arr = new Uint8Array(n);\n\n    while(n--) {\n      u8arr[n] = bstr.charCodeAt(n);\n    }\n\n    return new File([u8arr], filename, { type: mime });\n  }\n}\n"],"sourceRoot":"webpack:///"}